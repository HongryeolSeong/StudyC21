## Chapter_16 λ©”λ¨λ¦¬ λ™μ  ν• λ‹Ήπ―

μ„ μ–Έμ„ ν†µν•΄ μ €μ¥ κ³µκ°„μ„ λ―Έλ¦¬ ν™•λ³΄ν•  μ μμ§€λ§, λ•λ΅λ” ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ μ¤‘μ— μ €μ¥ κ³µκ°„μ„ ν• λ‹Ήν•  μ μμ–΄μ•Ό ν•λ‹¤.   

* mallocκ³Ό free ν•¨μ   
stdlib.h ν—¤λ” μΈν΄λ£¨λ“ ν›„ μ‚¬μ© κ°€λ¥   
```C
int main()
{
	int* pi; // λ™μ  ν• λ‹Ή μμ—­μ„ μ—°κ²°ν•  ν¬μΈν„° pi

	pi = (int *)malloc(sizeof(int)); // λ™μ  λ©”λ¨λ¦¬ ν• λ‹Ή
	if (pi == NULL) // λ™μ  ν• λ‹Ή μ‹¤ν¨μ‹ = ν¬μΈν„°κ°€ NULL λ°ν™μ‹
	{
		printf("# λ©”λ¨λ¦¬κ°€ λ¶€μ΅±ν•©λ‹λ‹¤.\n");
		exit(1); // ν”„λ΅κ·Έλ¨ μΆ…λ£
	}

	*pi = 10;
	
	free(pi); // λ™μ  λ©”λ¨λ¦¬ λ°ν™
}
```
μ„μ²λΌ malloc()μΌλ΅ μμ—­μ„ λ™μ  ν• λ‹Ή ν›„ free()λ΅ ν•΄λ‹Ή μμ—­μ„ λ°ν™ν•΄μ•Όν•λ‹¤   
<br>

* λ™μ  ν• λ‹Ή μμ—­μ„ λ°°μ—΄λ΅ ν™μ©   
ν• λ‹Ήλ κ³µκ°„μ μ‹μ‘μ„μΉλ¥Ό ν¬μΈν„°λ΅ μ—°κ²°μ‹ ν•΄λ‹Ή κ³µκ°„μ„ λ°°μ—΄λ΅ μ‚¬μ© κ°€λ¥.   
```C
int main()
{
	int* pi;
	int i, sum = 0; // sumμ€ μ—°μ‚°μ‹ μ²μ κ°’μ΄ μ“°λ κΈ° κ°’μ΄λ©΄ μ•λλ―€λ΅ 0μΌλ΅ μ΄κΈ°ν™”
	pi = (int*)malloc(5 * sizeof(int));
	if (pi == NULL)
	{
		printf("λ©”λ¨λ¦¬κ°€ λ¶€μ΅±ν•©λ‹λ‹¤!\n");
		exit(1);
	}
	for (i = 0; i < 5; i++)
	{
		scanf("%d", &pi[i]); // λ©”λ¨λ¦¬λ¥Ό λ°°μ—΄μ²λΌ μ‚¬μ©
		sum += pi[i];
	}
	free(pi);
}
```
<br>

* calloc, realloc ν•¨μ   
calloc() : λ©”λ¨λ¦¬ ν• λ‹Ήμ‹ κ³µκ°„μ„ 0μΌλ΅ μ΄κΈ°ν™”   
realloc() : μ΄λ―Έ λ™μ  ν• λ‹Ήλ κ³µκ°„μ ν¬κΈ°λ¥Ό μ΅°μ    
realloc() μ μμ    
-> κ³µκ°„ λ¶€μ΅±μ‹ μƒ λ©”λ¨λ¦¬ κ³µκ°„ ν• λ‹Ήν•μ—¬ κΈ°μ΅΄ μ”μ† λ³µμ‚¬   
-> but nullμ΄ λ°ν™λ  μ‹ κΈ°μ΅΄ μ£Όμ† μƒμ–΄λ²„λ¦Ό   
--> μ„μ‹ ν¬μΈν„°μ— realloc κ³µκ°„ λ°ν™ ν›„ μ‚¬μ©ν•  κ²ƒ   
```C
int main()
{
	int* pi; // λ™μ  ν• λ‹Ή κ³µκ°„κ³Ό μ—°κ²°ν•  ν¬μΈν„°
	int* pi_back; // realloc μ¤λ¥λ¥Ό λ€λΉ„ν• λ°±μ—… ν¬μΈν„°

	pi = (int*)calloc(size, sizeof(int)); // 5κ° κ³µκ°„ ν• λ‹Ή ν›„ μλ™μΌλ΅ 0μΌλ΅ μ΄κΈ°ν™”
	while (1)
	{
		if (count == size) // μ €μ¥ κ³µκ°„ λ¨λ‘ μ‚¬μ©μ‹
		{
			size += 5; // κ³µκ°„ ν¬κΈ° λλ ¤μ„
			pi_back = pi; // ν• λ‹Ή μ‹¤ν¨ λ°©μ§€ piμ κ³µκ°„ μ£Όμ†λ¥Ό pi_backμΌλ΅ λ°±μ—…
			pi = (int*)realloc(pi, size * sizeof(int)); // μ¬ν• λ‹Ή
			if (pi == NULL) // κ³µκ°„ ν• λ‹Ή μ‹¤ν¨μ‹
			{
				pi = pi_back; // λ°±μ—…ν–λ κ³µκ°„μ μ£Όμ†λ¥Ό λ‹¤μ‹ κΈ°μ΅΄ piν¬μΈν„°μ™€ μ—°κ²°
			}
		}
	}
	
	for (i = 0; i < count; i++)
	{
		printf("%5d", pi[i]);
	}
	free(pi);
}
```
μ„μ²λΌ piμ λ°±μ—… ν¬μΈν„°μΈ pi_backμ„ ν™μ©ν•μ—¬ reallocμ ν• λ‹Ή μ‹¤ν¨λ¥Ό λ°©μ§€ν•μ€λ‹¤.   
<br>

* λ™μ  ν• λ‹Ή ν™μ©ν• λ¬Έμμ—΄ μ²λ¦¬   
λ™μ  ν• λ‹Ήμ„ ν†µν•΄ ν¨μ¨μ μΈ λ¬Έμμ—΄ μ €μ¥ κ³µκ°„ κ΄€λ¦¬   
```C
int main()
{
	char temp[80]; // μ„μ‹ λ¬Έμμ—΄ λ°°μ—΄
	char* str[3]; // μµμΆ… λ¬Έμμ—΄ λ°°μ—΄
	int i;

	for (i = 0; i < 3; i++)
	{
		gets(temp);
		str[i] = (char*)malloc(strlen(temp) + 1); // μ„μ‹ λ°°μ—΄ κΈΈμ΄μ— + 1 ν•μ—¬ λ„λ¬ΈμκΉμ§€ μ…λ ¥λκ² ν•¨
		strcpy(str[i], temp); // λ™μ  ν• λ‹Ή λ μ„μ‹ λ°°μ—΄μ„ μµμΆ… λ°°μ—΄μΈ strμ— λ³µμ‚¬
	}

	for (i = 0; i < 3; i++) // λ™μ  ν• λ‹Ήλ λ¬Έμμ—΄ λ°°μ—΄μ κ³µκ°„μ„ ν•΄μ 
	{
		free(str[i]);
		printf("ν• λ‹Ήλ λ©”λ¨λ¦¬κ°€ λ°ν™λμ—μµλ‹λ‹¤.\n");
	}
}
```
